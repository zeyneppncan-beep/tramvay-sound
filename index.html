<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Tramvay YolculuÄŸu â€“ Sesli Model</title>

<script src="https://static.sketchfab.com/api/sketchfab-viewer-1.13.0.js"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: Arial, sans-serif;
}

/* Ana container */
#app {
  position: relative;
  width: 100%;
  height: 100%;
}

/* Sketchfab alanÄ± */
#viewer {
  position: absolute;
  inset: 0;
  z-index: 1;
}

/* SES BAÅžLAT BUTONU */
#startButton {
  position: absolute;
  z-index: 99999; /* ðŸ”´ EN ÃœSTTE */
  top: 20px;
  left: 20px;
  padding: 14px 20px;
  background: black;
  color: white;
  border: none;
  font-size: 14px;
  cursor: pointer;
  pointer-events: auto; /* ðŸ”´ TIKLANABÄ°LÄ°R */
}
</style>
</head>

<body>

<div id="app">
  <button id="startButton">ðŸ”Š Sesleri BaÅŸlat</button>
  <div id="viewer"></div>
</div>

<script>
/* ======================
   SESLER
====================== */
const sounds = [
  new Audio("sounds/trafik.mp3"),
  new Audio("sounds/ic_konusma.mp3"),
  new Audio("sounds/tramvay_ray.mp3"),
  new Audio("sounds/kapi.mp3"),
  new Audio("sounds/marti.mp3"),
  new Audio("sounds/nefes.mp3")
];

sounds.forEach(s => {
  s.loop = true;
  s.volume = 0.7;
});

let audioUnlocked = false;

function stopAllSounds() {
  sounds.forEach(s => {
    s.pause();
    s.currentTime = 0;
  });
}

/* ======================
   SES KÄ°LÄ°DÄ° (iOS)
====================== */
const startButton = document.getElementById("startButton");

startButton.addEventListener("click", () => {
  sounds[0].play().then(() => {
    sounds[0].pause();
    sounds[0].currentTime = 0;
    audioUnlocked = true;
    startButton.style.display = "none";
  }).catch(err => {
    console.log("Ses kilidi aÃ§Ä±lamadÄ±:", err);
  });
});

/* ======================
   SKETCHFAB
====================== */
const iframe = document.getElementById("viewer");
const client = new Sketchfab("1.13.0", iframe);

client.init("35d9707a712d4da1a88d1e4f82da8797", {
  autostart: 1,
  ui_infos: 0,
  ui_controls: 1,
  success: function (api) {
    api.start();

    api.addEventListener("annotationFocus", function(index) {
      if (!audioUnlocked) return;

      stopAllSounds();

      if (sounds[index]) {
        sounds[index].play();
      }
    });
  },
  error: function () {
    alert("Sketchfab model yÃ¼klenemedi");
  }
});
</script>

</body>
</html>
